"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[37],{4037:function(e,a,s){s.r(a);var r=s(885),t=s(2791),l=s(8820),n=s(1933),i=s(7689),d=s(9085),c=s(2208),o=s(2636),u=s(2408),m=s(2824),x=s(2424),h=s(184);a.default=function(){var e=(0,x.j)().cart,a=(0,i.s0)(),s=(0,n.useQueryClient)(),g=(0,t.useState)(""),p=(0,r.Z)(g,2),b=p[0],f=p[1],y=(0,t.useState)(""),j=(0,r.Z)(y,2),v=j[0],N=j[1],w=(0,t.useState)(""),C=(0,r.Z)(w,2),A=C[0],k=C[1],E=(0,t.useState)(""),R=(0,r.Z)(E,2),S=R[0],L=R[1],Z=(0,t.useState)("BALANCE"),_=(0,r.Z)(Z,2),F=_[0],T=_[1],U=(0,t.useState)("REGULAR"),D=(0,r.Z)(U,2),O=D[0],B=D[1],q=(0,t.useState)(!1),G=(0,r.Z)(q,2),K=G[0],Q=G[1],z=(0,t.useState)(!1),P=(0,r.Z)(z,2),Y=P[0],I=P[1],X=(0,t.useState)(!1),M=(0,r.Z)(X,2),V=M[0],H=M[1],J=(0,t.useState)(""),W=(0,r.Z)(J,2),$=W[0],ee=W[1],ae=(0,t.useRef)(0),se=(0,n.useQuery)("userAddress",(function(){return c.KD.getUserShippingAddress()})),re=(0,n.useQuery)("order",(function(){return c.KD.getOrdersUser()}),{enabled:!1}),te=(0,n.useQuery)("showerThought",(function(){return c.oD.showerThoughts()}),{staleTime:1e4,onSuccess:function(e){ee(e.data[ae.current]),ae.current++}});(0,t.useEffect)((function(){var e=setInterval((function(){var e,a;null!=te.data&&(ae.current===(null===(e=te.data)||void 0===e?void 0:e.data.length)&&(ae.current=0),ee(null===(a=te.data)||void 0===a?void 0:a.data[ae.current]),ae.current++)}),8e3);return function(){return clearInterval(e)}}),[te.data]);var le=(0,n.useMutation)(c.px.createOrder,{onSuccess:function(e){d.Am.success(e.message),re.refetch(),s.invalidateQueries("cart"),s.invalidateQueries("user"),a("/profile/order")},onError:function(e){d.Am.error(e.body.message),H(!1)}});if((0,t.useEffect)((function(){var e,a,s,r;K&&null!=se.data&&(f(null!==(e=se.data.address_name)&&void 0!==e?e:""),N(null!==(a=se.data.phone_number)&&void 0!==a?a:""),k(null!==(s=se.data.address)&&void 0!==s?s:""),L(null!==(r=se.data.city)&&void 0!==r?r:""))}),[K,se.data]),se.isLoading)return(0,h.jsx)("div",{children:"Loading..."});var ne=(0,m.v5)(e.data.reduce((function(e,a){return e+a.details.quantity*a.price}),0)),ie=ne<2e5?.15*ne:.2*ne,de=ne<3e5?.2*ne:.25*ne;return(0,h.jsxs)("main",{id:"main-content",className:"mx-auto mt-24 min-h-[60vh] max-w-7xl",children:[V&&(0,h.jsxs)("div",{className:"loading-overlay fixed top-0 left-0 z-50 flex h-full w-full flex-col items-center justify-center gap-y-4 bg-white bg-opacity-80",children:[(0,h.jsx)("p",{className:"text-2xl font-semibold text-gray-500",children:"Processing Your Order..."}),(0,h.jsx)(l.Z7b,{className:"my-3 animate-spin-slow text-7xl text-gray-300"}),(0,h.jsx)("p",{className:"text-xl font-semibold text-gray-400",children:$})]}),(0,h.jsx)("div",{className:"app-max-width w-full border-t-2 border-gray-100 px-4 sm:px-8 md:px-20",children:(0,h.jsx)("h1",{className:"mt-6 mb-2 text-center text-2xl sm:text-left sm:text-4xl",children:"Checkout"})}),(0,h.jsxs)("form",{className:"app-max-width mb-14 flex flex-col px-4 sm:px-8 md:px-20 lg:flex-row",onSubmit:function(e){e.preventDefault(),H(!0),le.mutate({shipping_method:"REGULAR"===O?"Regular":"Next Day",shipping_address:{address_name:b,phone_number:v,address:A,city:S},send_email:Y})},children:[(0,h.jsxs)("section",{className:"mr-8 h-full w-full lg:w-7/12",children:[(0,h.jsxs)("div",{className:"my-4",children:[(0,h.jsx)("label",{htmlFor:"addressName",className:"text-lg",children:"Addres Name"}),(0,h.jsx)(u.Z,{name:"addressName",type:"text",extraClass:"".concat(K?"bg-gray-100":""," w-full mt-1 mb-2"),border:"border-2 border-gray-400",value:b,onChange:function(e){return f(e.target.value)},readOnly:K,required:!0})]}),(0,h.jsxs)("div",{className:"my-4",children:[(0,h.jsx)("label",{htmlFor:"phoneNumber",className:"mb-1 text-lg",children:"Phone Number"}),(0,h.jsx)(u.Z,{name:"phoneNumber",type:"text",extraClass:"".concat(K?"bg-gray-100":""," w-full mt-1 mb-2"),border:"border-2 border-gray-400",value:v,onChange:function(e){return N(e.target.value)},readOnly:K,required:!0})]}),(0,h.jsxs)("div",{className:"my-4",children:[(0,h.jsx)("label",{htmlFor:"address",className:"text-lg",children:"Address"}),(0,h.jsx)(u.Z,{name:"address",type:"text",extraClass:"".concat(K?"bg-gray-100":""," w-full mt-1 mb-2"),border:"border-2 border-gray-400",value:A,onChange:function(e){return k(e.target.value)},readOnly:K,required:!0})]}),(0,h.jsxs)("div",{className:"my-4",children:[(0,h.jsx)("label",{htmlFor:"city",className:"text-lg",children:"City"}),(0,h.jsx)(u.Z,{name:"city",type:"text",extraClass:"".concat(K?"bg-gray-100":""," w-full mt-1 mb-2"),border:"border-2 border-gray-400",value:S,onChange:function(e){return L(e.target.value)},readOnly:K,required:!0})]}),(0,h.jsxs)("button",{type:"button",className:" flex place-items-center",onClick:function(){return Q(!K)},children:[(0,h.jsxs)("div",{className:"relative mr-2 inline-block w-10 select-none align-middle transition duration-200 ease-in",children:[(0,h.jsx)("input",{type:"checkbox",name:"toggle-user-address",id:"toggle-user-address",checked:K,onChange:function(){return Q(!K)},className:"".concat(K?"right-0 border-gray-500":"border-gray-300"," absolute block h-6 w-6 cursor-pointer appearance-none rounded-full border-4  bg-white")}),(0,h.jsx)("label",{htmlFor:"toggle",className:"".concat(K?" bg-gray-500":"bg-gray-300","  block h-6 cursor-pointer overflow-hidden rounded-full ")})]}),(0,h.jsx)("label",{htmlFor:"toggle-user-address",children:"Use my address as shipping address"})]})]}),(0,h.jsx)("section",{className:"mt-10 h-full w-full lg:mt-4 lg:w-5/12",children:(0,h.jsxs)("div",{className:"divide-y-2 divide-gray-200 border border-gray-500 p-6",children:[(0,h.jsxs)("div",{className:"flex justify-between",children:[(0,h.jsx)("span",{className:"mb-3 text-base uppercase",children:"Product"}),(0,h.jsx)("span",{className:"mb-3 text-base uppercase",children:"SUBTOTAL"})]}),(0,h.jsx)("div",{className:"pt-2",children:e.data.map((function(e){return(0,h.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,h.jsxs)("div",{className:"  flex",children:[(0,h.jsxs)("span",{className:"max-w-[10rem] overflow-clip text-ellipsis whitespace-pre text-base font-medium",children:[e.name," "]}),(0,h.jsxs)("span",{className:"text-gray-400",children:[" ","(",e.details.size,") x ",e.details.quantity]})]}),(0,h.jsx)("div",{className:"text-base",children:(0,m.fK)((0,m.v5)(e.price*e.details.quantity))})]},e.id)}))}),(0,h.jsxs)("div",{className:"flex justify-between py-3",children:[(0,h.jsx)("span",{className:"uppercase",children:"SUBTOTAL"}),(0,h.jsx)("span",{children:(0,m.fK)(ne)})]}),(0,h.jsxs)("div",{className:"py-3",children:[(0,h.jsx)("span",{className:"uppercase",children:"DELIVERY"}),(0,h.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,h.jsxs)("div",{className:"flex justify-between accent-gray-600",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("input",{type:"radio",name:"delivery",value:"REGULAR",id:"regular",checked:"REGULAR"===O,onChange:function(){return B("REGULAR")}})," ",(0,h.jsx)("label",{htmlFor:"regular",className:"cursor-pointer",children:"Regular"})]}),(0,h.jsx)("span",{children:(0,m.fK)(ie)})]}),(0,h.jsxs)("div",{className:"flex justify-between accent-gray-600",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("input",{type:"radio",name:"delivery",value:"NEXT_DAY",id:"next_day",checked:"NEXT_DAY"===O,onChange:function(){return B("NEXT_DAY")}})," ",(0,h.jsx)("label",{htmlFor:"next_day",className:"cursor-pointer",children:"Next Day"})]}),(0,h.jsx)("span",{children:(0,m.fK)(de)})]})]})]}),(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"flex justify-between py-3",children:[(0,h.jsx)("span",{children:"Grand Total"}),(0,h.jsx)("span",{children:(0,m.fK)((0,m.v5)(+ne+("REGULAR"===O?ie:de)))})]}),(0,h.jsx)("div",{className:"mt-2 mb-4 grid gap-4",children:(0,h.jsxs)("label",{htmlFor:"plan-bank",className:"relative flex cursor-pointer flex-col rounded-lg border border-gray-300 bg-white p-5 shadow-md",children:[(0,h.jsx)("span",{className:"font-semibold capitalize leading-tight text-gray-500",children:"Balance"}),(0,h.jsx)("span",{className:"mt-1 text-sm text-gray-400",children:"Pay with your balance"}),(0,h.jsx)("input",{type:"radio",name:"plan",id:"plan-bank",value:"BALANCE",className:"absolute h-0 w-0 appearance-none",onChange:function(){return T("BALANCE")}}),(0,h.jsx)("span",{"aria-hidden":"true",className:"".concat("BALANCE"===F?"block":"hidden"," absolute inset-0 rounded-lg border-2 border-gray-500 bg-opacity-10"),children:(0,h.jsx)("span",{className:"absolute top-4 right-4 inline-flex h-6 w-6 items-center justify-center rounded-full bg-gray-100",children:(0,h.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"h-5 w-5 text-green-600",children:(0,h.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})})]})}),(0,h.jsx)("div",{className:"my-8",children:(0,h.jsxs)("button",{type:"button",className:" flex place-items-center",onClick:function(){return I(!Y)},children:[(0,h.jsxs)("div",{className:"relative mr-2 inline-block w-10 select-none align-middle transition duration-200 ease-in",children:[(0,h.jsx)("input",{type:"checkbox",name:"toggle-user-email",id:"toggle-user-email",checked:Y,onChange:function(){return I(!Y)},className:"".concat(Y?"right-0 border-gray-500":"border-gray-300"," absolute block h-6 w-6 cursor-pointer appearance-none rounded-full border-4  bg-white")}),(0,h.jsx)("label",{htmlFor:"toggle",className:"".concat(Y?" bg-gray-500":"bg-gray-300","  block h-6 cursor-pointer overflow-hidden rounded-full ")})]}),(0,h.jsx)("label",{htmlFor:"toggle-user-email",children:"Send order detail to my email"})]})})]}),(0,h.jsx)(o.Z,{value:"Place Order",size:"xl",extraClass:"w-full",type:"submit"})]})})]})]})}}}]);
//# sourceMappingURL=37.3ef5f12e.chunk.js.map